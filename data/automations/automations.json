{
  "automations": [
    {
      "id": "session-end-audit",
      "name": "Session End Audit",
      "description": "Safety net after each session — catches what the external AI missed, writes handoff context.",
      "enabled": true,
      "trigger": "session_ended",
      "conditions": [],
      "actions": [],
      "ai_driven": true,
      "ai_prompt": "You are the session-end safety net. Your job is to catch anything the external AI (Cursor/Claude) missed during this work session and write handoff artifacts for the next session.\n\nIMPORTANT CONTEXT:\n- The State Cache above shows current project state (health, systems, roadmap NOW items, open issues, recent changelog, velocity).\n- The Change Queue above shows commits, activity reports, and session checkpoint data from this session.\n- Use these as your PRIMARY data sources. Only call tools to drill into specific items you need to update.\n\nSTEP 1 — TRIAGE FROM CHANGE QUEUE:\nReview the change queue. What commits happened? What files changed? What activity was reported?\nCross-reference with the state cache: do the open issues and in-progress roadmap items match what actually happened?\n\nSTEP 2 — TARGETED READS (use filters + summary mode):\n- Call list_backlog({status: 'in_progress', summary: true}) — are any in_progress items actually done based on the commits/activity?\n- Call list_backlog({horizon: 'now', summary: true}) — any NOW items that should be updated?\n- Call list_issues({status: 'open'}) — any open issues that the commits may have resolved?\nDo NOT read shipped/completed/resolved items. Do NOT read ideas or systems (nightly handles those).\n\nSTEP 3 — FIX GAPS:\nFor any item that's wrong (should be completed, missing data, stale status), call update_backlog_item or resolve_issue.\nFor any missing changelog entry, call add_changelog_entry.\nUpdate epic progress if items were completed.\n\nSTEP 4 — WRITE HANDOFF:\n- Call write_context_recovery with: briefing (what happened), hot_context (key files/modules touched), warnings (blockers/risks), suggestions (next priorities).\n- Call add_brain_note summarizing this session's key decisions and discoveries.\n- Call add_changelog_entry for the session if one wasn't already created.\n\nBUDGET: Complete in 2-4 rounds, 8-15 tool calls max. Use summary mode for scanning, full reads only when updating.",
      "max_iterations": 5,
      "allowed_tools": [
        "list_backlog",
        "update_backlog_item",
        "list_issues",
        "update_issue",
        "resolve_issue",
        "list_epics",
        "update_epic",
        "list_milestones",
        "update_milestone",
        "write_context_recovery",
        "add_brain_note",
        "add_changelog_entry",
        "get_session_info",
        "get_velocity",
        "get_git_status"
      ],
      "last_fired": "2026-02-09T01:25:56.872Z",
      "fire_count": 3,
      "created": "2026-02-08"
    },
    {
      "id": "change-tracker",
      "name": "Change Tracker",
      "description": "Surgical epic/milestone update when a roadmap item is completed.",
      "enabled": true,
      "trigger": "item_completed",
      "conditions": [],
      "actions": [],
      "ai_driven": true,
      "ai_prompt": "A roadmap item was just completed. The trigger data tells you which item.\n\nYour ONLY job is to update the parent epic and milestone:\n\n1. Read the trigger data to get the completed item ID and its epic_id.\n2. Call list_backlog({epic_id: '<epic_id>', summary: true}) to see all sibling items and their statuses.\n3. Calculate new completion count and progress percentage.\n4. Call update_epic to update completed_count, progress_pct, and ai_summary.\n5. If ALL items in the epic are completed, mark the epic status as 'completed'.\n6. If the item has a milestone_id, call update_milestone with updated progress.\n\nDo NOT read issues, ideas, systems, or docs.\nDo NOT create changelog entries (session-end handles that).\nDo NOT update project state (nightly handles that).\n\nBUDGET: Complete in 1 round, 2-4 tool calls max.",
      "max_iterations": 3,
      "allowed_tools": [
        "list_backlog",
        "update_backlog_item",
        "list_epics",
        "update_epic",
        "list_milestones",
        "update_milestone"
      ],
      "last_fired": "2026-02-09T00:34:48.797Z",
      "fire_count": 2,
      "created": "2026-02-08"
    },
    {
      "id": "nightly-audit",
      "name": "Nightly System Audit",
      "description": "Daily sweep for staleness, idea triage, system health, and project state — handles what session-end does NOT.",
      "enabled": true,
      "trigger": "scheduled",
      "conditions": [],
      "actions": [],
      "ai_driven": true,
      "ai_prompt": "This is the nightly audit. Session-end already handles roadmap freshness and issue resolution after each session. Your job covers DIFFERENT concerns.\n\nIMPORTANT: The State Cache and Change Queue above are your primary context. Use filtered reads and summary mode to minimize token usage.\n\nSTEP 1 — IDEAS TRIAGE:\nCall list_ideas({status: 'captured', summary: true}). For ideas older than 7 days still at 'captured' status, either promote to 'exploring' if they're valuable, or add notes explaining why they're waiting.\n\nSTEP 2 — SYSTEM HEALTH:\nCall list_systems. Reassess health scores based on: the open issues listed in the state cache, recent changelog entries, and the change queue. Systems with newly resolved issues should go up. Systems with new open issues should go down.\n\nSTEP 3 — STALENESS SWEEP:\nCall list_backlog({status: 'pending', summary: true}). Flag any item where the 'updated' date is older than 7 days — call update_backlog_item to add ai_notes explaining the stall.\n\nSTEP 4 — EPIC PROGRESS:\nCall list_epics. Recalculate progress_pct based on current roadmap item statuses. Update any epics that are out of sync.\n\nSTEP 5 — PROJECT STATE:\nCall update_project_state with a refreshed summary reflecting current reality.\n\nSTEP 6 — DAILY NOTE:\nCall add_brain_note with type 'observation' summarizing what the nightly audit found and changed.\n\nDo NOT update issues (session-end handles that). Do NOT write context_recovery. Do NOT regenerate docs. Do NOT read shipped/completed items unless checking epic progress.\n\nBUDGET: Complete in 3-5 rounds, 15-25 tool calls max.",
      "max_iterations": 8,
      "allowed_tools": [
        "list_backlog",
        "update_backlog_item",
        "list_ideas",
        "update_idea",
        "list_systems",
        "update_system",
        "list_epics",
        "update_epic",
        "list_milestones",
        "update_milestone",
        "update_project_state",
        "add_brain_note",
        "get_velocity"
      ],
      "last_fired": "2026-02-09T01:27:28.160Z",
      "fire_count": 3,
      "created": "2026-02-08"
    },
    {
      "id": "weekly-report",
      "name": "Weekly Progress Report",
      "description": "Weekly summary of velocity, health trends, accomplishments, and focus areas.",
      "enabled": true,
      "trigger": "scheduled",
      "conditions": [],
      "actions": [],
      "ai_driven": true,
      "ai_prompt": "Generate a weekly progress report. The State Cache above has most of what you need.\n\n1. Call get_velocity for exact session counts, items shipped, and points.\n2. Call get_session_info for recent session objectives and retros.\n3. Call list_changelog({limit: 20}) for this week's shipped work.\n\nFrom this data, write ONE brain note (type: 'observation', priority: 'medium') containing:\n- Velocity metrics: sessions this week, items shipped, points, avg per session\n- Major accomplishments: top 3-5 shipped items from changelog\n- Issue status: open vs resolved (from state cache)\n- Health trend: overall health direction\n- Focus suggestions: top 3 priorities for next week based on roadmap NOW items\n- Cost summary: if available from state cache\n\nDo NOT read backlog, ideas, systems, epics, or docs individually.\nDo NOT update any entities — this is a read-only report.\n\nBUDGET: Complete in 1-2 rounds, 3-5 tool calls max.",
      "max_iterations": 3,
      "allowed_tools": [
        "get_velocity",
        "get_session_info",
        "get_project_state",
        "add_brain_note",
        "list_changelog"
      ],
      "last_fired": "2026-02-09T01:27:02.128Z",
      "fire_count": 6,
      "created": "2026-02-08"
    },
    {
      "id": "weekly-deep-refresh",
      "name": "Weekly Deep Refresh",
      "description": "Comprehensive weekly audit — the ONLY automation that reads everything. Runs once per week.",
      "enabled": true,
      "trigger": "scheduled",
      "conditions": [],
      "actions": [],
      "ai_driven": true,
      "ai_prompt": "This is the weekly deep refresh — the ONLY automation that does a comprehensive full-system review. It runs once per week and has a higher budget than daily audits.\n\nYou have access to all tools. Read broadly, but use summary mode for initial scanning and only fetch full entities when you need to update them.\n\nSTEP 1 — FULL ROADMAP REVIEW:\nCall list_backlog({summary: true}) to see ALL items. Check for:\n- Items stuck in 'in_progress' for more than 1 week\n- Items in wrong horizon (should be promoted or demoted)\n- Missing epic assignments\n- Completed items that should be in 'shipped' horizon\nUpdate any items that need correction.\n\nSTEP 2 — FULL ISSUE REVIEW:\nCall list_issues({status: 'open'}) for full details on open issues. Check for:\n- Issues that reference resolved work but haven't been closed\n- Issues older than 2 weeks with no progress notes\n- Severity mismatches (critical issues that should be high, etc.)\nUpdate or resolve as needed.\n\nSTEP 3 — IDEAS LIFECYCLE:\nCall list_ideas({summary: true}) to review all non-dismissed ideas. Check for:\n- 'captured' ideas older than 14 days (promote, explore, or dismiss)\n- 'exploring' ideas that should be validated or promoted to roadmap\n- Duplicate ideas that should be merged\n\nSTEP 4 — SYSTEM HEALTH DEEP DIVE:\nCall list_systems. Do a thorough reassessment of each system's health based on all available data.\n\nSTEP 5 — EPIC/MILESTONE RECONCILIATION:\nCall list_epics and list_milestones. Ensure all progress percentages are accurate.\n\nSTEP 6 — BRAIN NOTE CLEANUP:\nCall get_brain_notes. Dismiss notes older than 2 weeks that have been actioned or are no longer relevant.\n\nSTEP 7 — PROJECT STATE + BRAIN NOTE:\nUpdate project state summary. Write a brain note summarizing the deep refresh findings.\n\nBUDGET: This is the expensive audit. Up to 8 iterations, 30-40 tool calls. Target cost: $1-2.",
      "max_iterations": 10,
      "allowed_tools": null,
      "last_fired": "2026-02-09T01:29:24.705Z",
      "fire_count": 1,
      "created": "2026-02-09"
    },
    {
      "id": "docs-refresh",
      "name": "Documentation Refresh",
      "description": "Keep auto-generated documentation up to date when source data changes.",
      "enabled": false,
      "trigger": "scheduled",
      "conditions": [],
      "actions": [],
      "ai_driven": true,
      "ai_prompt": "DISABLED — Docs generation is manual-only via the Docs tab UI. This automation is kept for reference but should not run automatically due to high cost.",
      "max_iterations": 3,
      "allowed_tools": null,
      "last_fired": "2026-02-08T04:25:00.350Z",
      "fire_count": 0,
      "created": "2026-02-08"
    }
  ]
}
